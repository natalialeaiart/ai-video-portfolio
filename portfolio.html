<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My AI Video Portfolio</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Raleway:wght@400;600&display=swap');
        
        :root {
            /* Новая цветовая схема на основе #69bbd6 */
            --primary-color: #69bbd6;
            --primary-dark: #4a9bb8;
            --primary-darker: #3a7a93;
            --background-light: #e8f4f8;
            --background-medium: #f0f8fb;
            --text-dark: #2c3e50;
            --text-light: #ffffff;
            --shadow-color: rgba(105, 187, 214, 0.1);
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Raleway', sans-serif;
            background-color: var(--background-light);
            margin: 0;
            padding: 0;
            color: var(--text-dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            background-color: var(--background-medium);
            min-height: 100vh;
        }
        
        h1 {
            text-align: center;
            color: var(--text-dark);
            margin-bottom: 30px;
            font-size: 2.5rem;
            font-weight: 600;
        }
        
        .filters {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 40px;
        }
        
        .filters button {
            padding: 12px 24px;
            border: none;
            background-color: var(--primary-dark);
            color: var(--text-light);
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            box-shadow: 0 2px 8px var(--shadow-color);
        }
        
        .filters button:hover {
            background-color: var(--primary-darker);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow-color);
        }
        
        .filters button.active {
            background-color: var(--primary-color);
            box-shadow: 0 4px 16px var(--shadow-color);
        }
        
        .video-section {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .video-section.active {
            display: block;
            opacity: 1;
        }
        
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            transform: translateZ(0);
            will-change: scroll-position;
        }
        
        .video-wrapper {
            position: relative;
            aspect-ratio: 16 / 9;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transform: translateZ(0);
            backface-visibility: hidden;
            transition: transform 0.3s ease;
            box-shadow: 0 4px 20px var(--shadow-color);
        }
        
        .video-wrapper:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 8px 30px var(--shadow-color);
        }
        
        .video-placeholder {
            position: relative;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--background-light), var(--primary-color));
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .video-placeholder img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transition: opacity 0.3s ease;
        }
        
        .video-placeholder.loading img {
            opacity: 0.7;
        }
        
        .play-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            border: none;
            border-radius: 50%;
            width: 70px;
            height: 70px;
            color: var(--text-light);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            backdrop-filter: blur(10px);
        }
        
        .play-button:hover {
            background: var(--primary-color);
            transform: translate(-50%, -50%) scale(1.15);
            box-shadow: 0 4px 20px rgba(105, 187, 214, 0.4);
        }
        
        .play-button::before {
            content: '▶';
            margin-left: 3px;
        }
        
        .video-iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 12px;
        }
        
        .video-skeleton {
            background: linear-gradient(90deg, var(--background-light) 25%, var(--primary-color) 50%, var(--background-light) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        .video-title {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
            color: var(--text-light);
            padding: 20px 15px 15px;
            font-size: 0.9rem;
            font-weight: 500;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .video-wrapper:hover .video-title {
            opacity: 1;
        }
        
        .loading-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--primary-color);
            font-size: 1.2rem;
            font-weight: 600;
            display: none;
        }
        
        .video-placeholder.loading .loading-indicator {
            display: block;
        }
        
        .video-placeholder.loading .play-button {
            display: none;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 2rem;
                margin-bottom: 20px;
            }
            
            .video-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .video-wrapper:hover {
                transform: none;
            }
            
            .filters {
                flex-direction: row;
                justify-content: center;
                gap: 8px;
            }
            
            .filters button {
                padding: 10px 16px;
                font-size: 0.9rem;
            }
            
            .play-button {
                width: 60px;
                height: 60px;
                font-size: 20px;
            }
        }
        
        @media (max-width: 480px) {
            .video-grid {
                gap: 12px;
            }
            
            .filters button {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>My AI Video Portfolio</h1>
        
        <div class="filters">
            <button class="filter-btn active" data-filter="brands">Brands</button>
            <button class="filter-btn" data-filter="photoshoots">Photoshoots</button>
            <button class="filter-btn" data-filter="others">Others</button>
        </div>

        <div class="video-section active" id="brands">
            <div class="video-grid">
                <div class="video-wrapper" data-video-id="aBqTdrwx3FY" data-title="Swimsuit by 12storeez">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/aBqTdrwx3FY/maxresdefault.jpg" alt="Swimsuit by 12storeez" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Swimsuit by 12storeez</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="pqFWvR4asYs" data-title="Реклама LED ламп">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/pqFWvR4asYs/maxresdefault.jpg" alt="Реклама LED ламп" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Реклама LED ламп</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="kq-E46J77x4" data-title="Hockey Club Video">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/kq-E46J77x4/maxresdefault.jpg" alt="Hockey Club Video" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Hockey Club Video</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="vr8Nfdx9-aE" data-title="Coffee Campaign">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/vr8Nfdx9-aE/maxresdefault.jpg" alt="Coffee Campaign" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Coffee Campaign</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="pd3g22qIeGo" data-title="Cardigan Campaign Part 1">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/pd3g22qIeGo/maxresdefault.jpg" alt="Cardigan Campaign Part 1" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Cardigan Campaign Part 1</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="uAXSg76zE3Y" data-title="Cardigan Campaign Part 2">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/uAXSg76zE3Y/maxresdefault.jpg" alt="Cardigan Campaign Part 2" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Cardigan Campaign Part 2</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="5vIEm6KOISk" data-title="SPF Campaign">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/5vIEm6KOISk/maxresdefault.jpg" alt="SPF Campaign" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">SPF Campaign</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="E7chRx44aBM" data-title="Rouge Campaign">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/E7chRx44aBM/maxresdefault.jpg" alt="Rouge Campaign" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Rouge Campaign</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="qfWMkP8nfNg" data-title="Lipstick Campaign">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/qfWMkP8nfNg/maxresdefault.jpg" alt="Lipstick Campaign" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Lipstick Campaign</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="WZg_kY097V4" data-title="Bath Campaign">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/WZg_kY097V4/maxresdefault.jpg" alt="Bath Campaign" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Bath Campaign</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="qywut7l-D-Y" data-title="Givenchy Campaign">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/qywut7l-D-Y/maxresdefault.jpg" alt="Givenchy Campaign" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Givenchy Campaign</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="_M-iROZCfvI" data-title="Atlas Campaign">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/_M-iROZCfvI/maxresdefault.jpg" alt="Atlas Campaign" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Atlas Campaign</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="4dAFx6xGrB0" data-title="Painting Campaign">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/4dAFx6xGrB0/maxresdefault.jpg" alt="Painting Campaign" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Painting Campaign</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="NWCL_1-jqSA" data-title="Real & Not Real">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/NWCL_1-jqSA/maxresdefault.jpg" alt="Real & Not Real" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Real & Not Real</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="qd2ZF5P517M" data-title="Cartier Campaign">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/qd2ZF5P517M/maxresdefault.jpg" alt="Cartier Campaign" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Cartier Campaign</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="d2hQ5XG-ip4" data-title="Fashion Campaign">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/d2hQ5XG-ip4/maxresdefault.jpg" alt="Fashion Campaign" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Fashion Campaign</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="-6oOwnnzgaI" data-title="Autumn Campaign">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/-6oOwnnzgaI/maxresdefault.jpg" alt="Autumn Campaign" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Autumn Campaign</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="m-PSq9AZHpc" data-title="Winter Campaign">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/m-PSq9AZHpc/maxresdefault.jpg" alt="Winter Campaign" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Winter Campaign</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="video-section" id="photoshoots">
            <div class="video-grid">
                <div class="video-wrapper" data-video-id="V13JJvcQntU" data-title="Fashion Photoshoot 1">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/V13JJvcQntU/maxresdefault.jpg" alt="Fashion Photoshoot 1" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Fashion Photoshoot 1</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="WTXeiD0twDo" data-title="Fashion Photoshoot 2">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/WTXeiD0twDo/maxresdefault.jpg" alt="Fashion Photoshoot 2" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Fashion Photoshoot 2</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="sitdwXD_BZ8" data-title="Fashion Photoshoot 3">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/sitdwXD_BZ8/maxresdefault.jpg" alt="Fashion Photoshoot 3" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Fashion Photoshoot 3</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="DOJT6cJQc18" data-title="Fashion Photoshoot 4">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/DOJT6cJQc18/maxresdefault.jpg" alt="Fashion Photoshoot 4" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Fashion Photoshoot 4</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="7obwPPPRUdo" data-title="Fashion Photoshoot 5">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/7obwPPPRUdo/maxresdefault.jpg" alt="Fashion Photoshoot 5" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Fashion Photoshoot 5</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="PuwwVvycZMY" data-title="Fashion Photoshoot 6">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/PuwwVvycZMY/maxresdefault.jpg" alt="Fashion Photoshoot 6" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Fashion Photoshoot 6</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="_VaqraUD6e8" data-title="Fashion Photoshoot 7">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/_VaqraUD6e8/maxresdefault.jpg" alt="Fashion Photoshoot 7" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Fashion Photoshoot 7</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="PNCbjWLBqYo" data-title="Fashion Photoshoot 8">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/PNCbjWLBqYo/maxresdefault.jpg" alt="Fashion Photoshoot 8" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Fashion Photoshoot 8</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="FwmmKqfhWdo" data-title="Fashion Photoshoot 9">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/FwmmKqfhWdo/maxresdefault.jpg" alt="Fashion Photoshoot 9" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Fashion Photoshoot 9</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="video-section" id="others">
            <div class="video-grid">
                <div class="video-wrapper" data-video-id="odpBecbqo4c" data-title="Creative Project 1">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/odpBecbqo4c/maxresdefault.jpg" alt="Creative Project 1" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Creative Project 1</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="7XkV8CLtqCE" data-title="Creative Project 2">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/7XkV8CLtqCE/maxresdefault.jpg" alt="Creative Project 2" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Creative Project 2</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="2tpgFKdRmLA" data-title="Creative Project 3">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/2tpgFKdRmLA/maxresdefault.jpg" alt="Creative Project 3" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Creative Project 3</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="ru3Jjrj7xrc" data-title="Creative Project 4">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/ru3Jjrj7xrc/maxresdefault.jpg" alt="Creative Project 4" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Creative Project 4</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="JVB2wgpLZqA" data-title="Creative Project 5">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/JVB2wgpLZqA/maxresdefault.jpg" alt="Creative Project 5" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Creative Project 5</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="NW-CAR97KlE" data-title="Creative Project 6">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/NW-CAR97KlE/maxresdefault.jpg" alt="Creative Project 6" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Creative Project 6</div>
                    </div>
                </div>
                
                <div class="video-wrapper" data-video-id="MdlZTDZI64U" data-title="Creative Project 7">
                    <div class="video-placeholder">
                        <img src="https://img.youtube.com/vi/MdlZTDZI64U/maxresdefault.jpg" alt="Creative Project 7" loading="lazy">
                        <button class="play-button" aria-label="Play video"></button>
                        <div class="loading-indicator">Loading...</div>
                        <div class="video-title">Creative Project 7</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class VideoPortfolio {
            constructor() {
                this.loadedVideos = new Set();
                this.maxConcurrentLoads = 2;
                this.currentlyLoading = 0;
                this.loadQueue = [];
                
                this.init();
            }
            
            init() {
                this.setupFilters();
                this.setupVideoLoading();
                this.setupIntersectionObserver();
            }
            
            setupFilters() {
                const filterButtons = document.querySelectorAll('.filter-btn');
                const videoSections = document.querySelectorAll('.video-section');
                
                filterButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        // Удаляем активный класс со всех кнопок и секций
                        filterButtons.forEach(btn => btn.classList.remove('active'));
                        videoSections.forEach(section => section.classList.remove('active'));
                        
                        // Добавляем активный класс к выбранной кнопке и секции
                        button.classList.add('active');
                        const targetSection = document.getElementById(button.dataset.filter);
                        if (targetSection) {
                            targetSection.classList.add('active');
                        }
                    });
                });
            }
            
            setupVideoLoading() {
                document.addEventListener('click', (e) => {
                    const playButton = e.target.closest('.play-button');
                    if (playButton) {
                        const videoWrapper = playButton.closest('.video-wrapper');
                        if (videoWrapper && !this.loadedVideos.has(videoWrapper)) {
                            this.loadVideo(videoWrapper);
                        }
                    }
                });
            }
            
            setupIntersectionObserver() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const videoWrapper = entry.target;
                            this.preloadThumbnail(videoWrapper);
                        }
                    });
                }, {
                    rootMargin: '100px'
                });
                
                document.querySelectorAll('.video-wrapper').forEach(wrapper => {
                    observer.observe(wrapper);
                });
            }
            
            preloadThumbnail(videoWrapper) {
                const img = videoWrapper.querySelector('img');
                if (img && !img.complete) {
                    img.addEventListener('load', () => {
                        videoWrapper.classList.add('thumbnail-loaded');
                    });
                }
            }
            
            async loadVideo(videoWrapper) {
                if (this.loadedVideos.has(videoWrapper)) return;
                
                this.loadedVideos.add(videoWrapper);
                const videoId = videoWrapper.dataset.videoId;
                const placeholder = videoWrapper.querySelector('.video-placeholder');
                
                // Показываем индикатор загрузки
                placeholder.classList.add('loading');
                
                try {
                    const iframe = this.createIframe(videoId);
                    
                    // Ждем загрузки iframe
                    await this.waitForIframeLoad(iframe);
                    
                    // Заменяем placeholder на iframe с плавным переходом
                    videoWrapper.style.opacity = '0.7';
                    setTimeout(() => {
                        videoWrapper.innerHTML = '';
                        videoWrapper.appendChild(iframe);
                        videoWrapper.style.opacity = '1';
                    }, 200);
                    
                } catch (error) {
                    console.error('Error loading video:', error);
                    placeholder.classList.remove('loading');
                    this.loadedVideos.delete(videoWrapper);
                }
            }
            
            createIframe(videoId) {
                const iframe = document.createElement('iframe');
                iframe.className = 'video-iframe';
                iframe.src = `https://www.youtube-nocookie.com/embed/${videoId}?autoplay=1&rel=0&modestbranding=1&playsinline=1&origin=${window.location.origin}`;
                iframe.allowFullscreen = true;
                iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
                iframe.loading = 'lazy';
                
                return iframe;
            }
            
            waitForIframeLoad(iframe) {
                return new Promise((resolve, reject) => {
                    const timeout = setTimeout(() => {
                        reject(new Error('Iframe load timeout'));
                    }, 8000);
                    
                    iframe.addEventListener('load', () => {
                        clearTimeout(timeout);
                        resolve();
                    });
                    
                    iframe.addEventListener('error', () => {
                        clearTimeout(timeout);
                        reject(new Error('Iframe load error'));
                    });
                });
            }
        }
        
        // Инициализация после загрузки DOM
        document.addEventListener('DOMContentLoaded', () => {
            new VideoPortfolio();
        });
        
        // Регистрация Service Worker (если доступен)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            });
        }
    </script>
</body>
</html>

